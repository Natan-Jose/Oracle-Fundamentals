|-------------------------------------------------------------------------------|
| Aula      : Conceitos baÌsicos do RMAN											| 
| MÃ³dulo    : Basic Backup and Recovery                                         |
| Curso     : Oracle Fundamentals                                               |
| Instrutor : Marcio Mandarino                                                  |
| URL       : mrdba.com.br/oracle_fundamentals                                  |
|-------------------------------------------------------------------------------|
| ReferÃªncia: https://docs.oracle.com/en/database/oracle/oracle-database/19/bradv/part-overview-backup-recovery.html#GUID-CD5F857C-198E-4097-A5C8-F0D7E9C00D30
|-------------------------------------------------------------------------------|


=================================================================
== ğŸ¯ Objetivos da Aula:
=================================================================
ğŸ’¡ Aprender conceitos teÃ³ricos sobre o RMAN
ğŸ’¡ Compreender como funciona e algumas das capacidades do RMAN


=================================================================
== ğŸ¯ Resumo
=================================================================
ğŸ“ Conceito geral
ğŸ“ Primeiros Passos no RMAN
ğŸ“ Principais Recursos do RMAN
ğŸ“ Arquitetura do RMAN
ğŸ“ Arquivos que o RMAN faz backup
ğŸ“ Canais do RMAN
ğŸ“ Archivelog mode
ğŸ“ Fast Recovery Area (FRA)
ğŸ“ Tipos de backup
ğŸ“ EstratÃ©gia (PolÃ­tica de backup)
ğŸ“ O dia a dia com o RMAN
ğŸ“ Teste de restore
ğŸ“ ConclusÃ£o


=================================================================
== ğŸ¯ Conceito geral
=================================================================
â–¶ï¸ RMAN significa Recovery Manager!
â–¶ï¸ O RMAN Ã© a principal ferramenta de backup do Oracle e todo DBA deve ter domÃ­nio sobre ele. 
â–¶ï¸ NÃ£o hÃ¡ custos adicionais, jÃ¡ vem instalado com o Oracle por default, porÃ©m hÃ¡ features que estÃ£o disponÃ­veis apenas no EE
â–¶ï¸ O RMAN Ã© um mundo, dÃª um passo de cada vez
ğŸ’¡ A maior responsabilidade do DBA Ã© garantir o recovery do banco
ğŸ’€ Se vocÃª perder um banco de dados e nÃ£o for capaz de recuperÃ¡-lo, provavelmente vocÃª tambÃ©m vai perder seu emprego
	âœ… NÃ£o Ã© de responsabilidade do DBA jÃºnior essa questÃ£o 
â–¶ï¸ Uma das suas metas como DBA deve ser alcanÃ§ar o domÃ­nio do RMAN e isso vai levar tempo. NÃ£o se preocupe com isso
ğŸ’¡ VocÃª vai dominar o RMAN praticando (e muito!)
ğŸ’€ Nunca aceite o Data Pump Export como "ferramenta" de backup!


=================================================================
== ğŸ¯ Primeiros Passos no RMAN
=================================================================
â–¶ï¸ Em primeiro lugar, vocÃª deve conhecer os conceitos do RMAN.
â–¶ï¸ VocÃª deve conhecer de uma forma geral, do que o RMAN Ã© capaz, mesmo que vocÃª ainda nÃ£o seja capaz de fazer tudo
â–¶ï¸ Seja capaz de entender as estratÃ©gias de backup do RMAN
â–¶ï¸ Saiba conferir se os backups estÃ£o sendo executados (principal atividade de um iniciante, no que diz respeito a backup)
â–¶ï¸ Aprender a ver as configuraÃ§Ãµes do RMAN
â–¶ï¸ Saiba fazer um backup do RMAN
â–¶ï¸ Saiba fazer um restore do RMAN (da maneira mais simples)


=================================================================
== ğŸ¯ Principais Recursos do RMAN
=================================================================
â–¶ï¸ Backup completo ou parcial do banco
â–¶ï¸ Backup online (depende do banco estar em archivelog mode)
â–¶ï¸ CompressÃ£o de backup
â–¶ï¸ Paralelismo
â–¶ï¸ Criptografia
â–¶ï¸ IntegraÃ§Ã£o com ferramentas de terceiros


=================================================================
== ğŸ¯ Arquitetura do RMAN
=================================================================
â–¶ï¸ O RMAN tem algumas componentes que compÃµe sua arquitetura
â–¶ï¸ Client: Simplesmente o executÃ¡vel do rman, muito similar ao sqlplus
â–¶ï¸ Target Database: Ã‰ o banco de dados que serÃ¡ feito o backup e/ou recuperaÃ§Ã£o
â–¶ï¸ Recovery Catalog: Ã‰ o local aonde ficam salvas as informaÃ§Ãµes dos backups realizados, o catÃ¡logo pode ser:
	â–«ï¸ Control File: Por default, todas as informaÃ§Ãµes de backup ficam salvas no Control File
	â–«ï¸ Banco de dados de catÃ¡logo: Ã‰ uma opÃ§Ã£o que podemos centralizar vÃ¡rias informaÃ§Ãµes de backup de vÃ¡rios databases
â–¶ï¸ Media Management: Ã‰ o local no qual os backups sÃ£o salvos, por padrÃ£o Ã© no disco, mas pode ser configurado para um local externo:
	â–«ï¸ Unidade de Fita
	â–«ï¸ Storage Externo
	â–«ï¸ OCI
â–¶ï¸ Fast Recovery Area: Ã‰ uma Ã¡rea em disco (Opcional) que o Oracle armazena e administra automaticamente os backups
	ğŸ’¡ Ã‰ muito Ãºtil no dia a dia do DBA. Procure sempre utilizar
https://docs.oracle.com/en/database/oracle/oracle-database/19/bradv/img/bradv038.gif


=================================================================
== ğŸ¯ Canais do RMAN
=================================================================
â–¶ï¸ Um canal do RMAN representa um stream de dados para um dispositivo 
	â–«ï¸ (Um canal representa a comunicaÃ§Ã£o entre o banco de dados e o dispositivo)
â–¶ï¸ Corresponde a uma sessÃ£o no banco de dados
â–¶ï¸ Durante o processo de backup e recuperaÃ§Ã£o, o canal lÃª os dados da origem e grava no destino
â–¶ï¸ Aumentar o nÃºmero de canais, geralmente aumenta a velocidade do backup ou do recovery


=================================================================
== ğŸ¯ Arquivos que o RMAN faz backup
=================================================================
â–¶ï¸ O RMAN faz backup de arquivos!
	â–«ï¸ Datafiles
	â–«ï¸ Control Files
	â–«ï¸ Archives
	â–«ï¸ Spfile	

=================================================================
== ğŸ¯ Archivelog Mode
=================================================================
â–¶ï¸ Se o banco Ã© importante, ele deve estar em archivelog mode!
â–¶ï¸ Se ele nÃ£o Ã© importante, qual a razÃ£o dele existir? 
ğŸ’¡ Sempre mantenha os bancos com archive ligado
ğŸ’¡ Se alguÃ©m questionar sua decisÃ£o, pergunte como seria para a empresa lidar com a perda do banco.


=================================================================
== ğŸ¯ Fast Recovery Area (FRA)
=================================================================
â–¶ï¸ Ãrea designada para armazenar backups, archived logs e control files
â–¶ï¸ Muito mais fÃ¡cil gerenciar os backups usando a FRA
â–¶ï¸ Facilita a recuperaÃ§Ã£o rÃ¡pida do banco de dados
ğŸ’¡ Procure sempre usar a FRA!
â–¶ï¸ Ã‰ muito simples, basicamente vocÃª define dois parÃ¢metros:
	â–«ï¸ db_recovery_file_dest
	â–«ï¸ db_recovery_file_dest_size
â–¶ï¸ No mÃ³dulo de instalaÃ§Ã£o do Oracle, esses parÃ¢metros foram definidos na criaÃ§Ã£o do banco!


=================================================================
== ğŸ¯ Tipos de backup
=================================================================
â–¶ï¸ O RMAN suporte os seguintes tipos de backups: Full, Incremental e de archives
â–¶ï¸ Um backup Full contÃ©m todos os arquivos de dados do banco de dados
â–¶ï¸ O backup incremental Ã© divido em dois tipos de backup 0 e 1
	â–«ï¸ O backup level 0 Ã© o equivalente ao backup full
	â–«ï¸ O backup level 1 pode ser do tipo Diferencial ou cumulativo
		â–«ï¸ O backup diferencial contÃ©m todos os blocos alterados desde backup incremental mais recente (0 ou 1)	
		â–«ï¸ O backup cumulativo contÃ©m todos os blocos alterados desde backup incremental level 0 mais recente

â–¶ï¸ CenÃ¡rio tÃ­pico de um backup incremental:
Domingo	: Backup Level 0 
Segunda	: Backup Level 1 Diferencial (copia todos os blocos desde o backup level 0 de domingo)
TerÃ§a	: Backup Level 1 Diferencial (copia todos os blocos desde o backup level 1 de segunda)
Quarta	: Backup Level 1 Diferencial (copia todos os blocos desde o backup level 1 de terÃ§a)
Quinta	: Backup Level 1 Cumulativo  (copia todos os blocos desde o backup level 0 de domingo)
Sexta	: Backup Level 1 Diferencial (copia todos os blocos desde o backup level 1 de quinta)
SÃ¡bado	: Backup Level 1 Diferencial (copia todos os blocos desde o backup level 1 de sexta)


=================================================================
== ğŸ¯ EstratÃ©gia (PolÃ­tica de backup)
=================================================================
â–¶ï¸ Qual serÃ¡ a frequÃªncia do backup? 
â–¶ï¸ Por quanto tempo o backup serÃ¡ armazenado? 
â–¶ï¸ Qual o local de armazenamento do backup?
â–¶ï¸ Existem vÃ¡rios fatores que influenciam na polÃ­tica de backup, por exemplo:
	â–«ï¸ Tamanho do banco
	â–«ï¸ Janela de backup
	â–«ï¸ EspaÃ§o para armazenar o backup
	â–«ï¸ DuraÃ§Ã£o do backup

â–¶ï¸ EstratÃ©gia tÃ­pica de backup para ambientes pequenos:
	â–«ï¸ Backup Full diÃ¡rio
	â–«ï¸ Backup de archives de hora em hora
	â–«ï¸ Configurar a Fast Recovery Area para reter 1 backup 
 	â–«ï¸ Guardar o backup em uma unidade externa (fita, storage, cloud) por 30 dias

â–¶ï¸ EstratÃ©gia tÃ­pica de backup para ambientes grandes:
	â–«ï¸ Backup incremental (Full) no fim de semana	
	â–«ï¸ Backup icremental (Diferencial ou Cumulativo) diÃ¡rio
	â–«ï¸ Backup de archives de hora em hora
	â–«ï¸ Configurar a Fast Recovery Area para reter 1 backup 
 	â–«ï¸ Guardar o backup em uma unidade externa (fita, storage, cloud) por 30 dias





=================================================================
== ğŸ¯ O dia a dia com o RMAN
=================================================================
â–¶ï¸ O DBA aplica a estratÃ©gia de backup uma vez e sÃ³ muda quando hÃ¡ uma necessidade de mudar a estratÃ©gia
â–¶ï¸ Depois que configura o RMAN para refletir a estratÃ©gia de backup, ele entra no modo "Piloto AutomÃ¡tico"
	âš ï¸ Cuidado com o "Piloto automÃ¡tico"!
â–¶ï¸ Ã‰ importante conferir se o backup estÃ¡ sendo executado corretamente dentro da polÃ­tica de backup
â–¶ï¸ Eventualmente executar um backup que falhou


=================================================================
== ğŸ¯ Teste de restore
=================================================================
â–¶ï¸ Ã‰ o melhor amigo do DBA
â–¶ï¸ VocÃª garante que o processo de backup tÃ¡ funcionando e tambÃ©m garante seu emprego
â–¶ï¸ VocÃª pode simular cenÃ¡rios de recuperaÃ§Ã£o. A empresa paga para vocÃª aprender!
â–¶ï¸ Recuperar um banco apÃ³s uma falha, Ã© um cenÃ¡rio de estresse. O teste de restore Ã© o calmante do DBA


=================================================================
== ğŸ¯ ConclusÃ£o
=================================================================
ğŸ’¡ VocÃª nÃ£o deve se cobrar de saber tudo sobre o RMAN
ğŸ’¡ Siga um processo de aprendizado, atÃ© alcanÃ§ar o domÃ­nio
ğŸ’¡ No inÃ­cio, o que vocÃª precisa saber Ã© bem bÃ¡sico, entÃ£o se preocupe em ser bom no bÃ¡sico!
 