|-------------------------------------------------------------------------------|
| Aula		: Definindo variÃ¡veis de ambiente									|
| MÃ³dulo	: Managing Oracle Database											|
| Curso		: Oracle Fundamentals												|
| Instrutor	: Marcio Mandarino													|
| URL		: mrdba.com.br/oracle_fundamentals									|
|-------------------------------------------------------------------------------|

=================================================================
== ðŸŽ¯ Objetivos da Aula
=================================================================
ðŸ’¡ Entender como definir corretamente as variÃ¡veis de ambiente 
ðŸ’¡ VariÃ¡veis de ambiente em Oracle RAC


========================================================================================
== ðŸŽ¯ Resumo
========================================================================================
ðŸ“ Configurando as variÃ¡veis manualmente
ðŸ“ UtilitÃ¡rio oraenv
ðŸ“ Ajustando o bash_profile
ðŸ“ VariÃ¡veis adicionais


========================================================================================
== ðŸŽ¯ Conceito geral
========================================================================================
â–¶ï¸ Uma das questÃµes mais bÃ¡sicas para um DBA Ã© saber definir as variÃ¡veis de forma correta
â–¶ï¸ Duas variÃ¡veis sÃ£o obrigatÃ³rias: ORACLE_HOME e ORACLE_SID
â–¶ï¸ Definir a variÃ¡vel PATH Ã© importante para nÃ£o precisar passar o diretÃ³rio do utilitÃ¡rio
âš ï¸ Ã‰ comum termos servidores com vÃ¡rios databases e mais de uma ORACLE_HOME


========================================================================================
== ðŸŽ¯ MÃ©todo 1: Configurando as variÃ¡veis manualmente
========================================================================================
$ env | grep 'ORACLE\|PATH' 

$ cat etc/oratab

$ export ORACLE_HOME=/opt/oracle/product/19c/dbhome_1
$ export ORACLE_SID=ORCLCDB
$ export PATH=$ORACLE_HOME/bin:$PATH


$ sqlplus / as sysdba
$ env | grep 'ORACLE\|PATH' 


========================================================================================
== ðŸŽ¯ MÃ©todo 2: UtilitÃ¡rio oraenv
========================================================================================
$ env | grep 'ORACLE\|PATH' 
$ cat /etc/oratab
$ . oraenv

$ env | grep 'ORACLE\|PATH' 
$ sqlplus / as sysdba


========================================================================================
== ðŸŽ¯ MÃ©todo 3: Ajustando o bash_profile
========================================================================================
$ cat >> /home/oracle/.bash_profile <<EOF
export ORACLE_SID=ORCLCDB
export ORACLE_BASE=/opt/oracle
export ORACLE_HOME=/opt/oracle/product/19c/dbhome_1

export PATH=\$ORACLE_HOME/bin:\$PATH
EOF


$ cat /home/oracle/.bash_profile

$ env | grep 'ORACLE\|PATH' 
$ sqlplus / as sysdba


========================================================================================
== ðŸŽ¯ MÃ©todo 4: Criando scripts personalizados
========================================================================================
$ . oraenv
$ env | grep 'ORACLE\|PATH' 

-- Criar um arquivo nome_db.env com as variÃ¡veis  

$ cat scripts/setEnv.sh (Copiar)
$ vi cdb1.env (Colar) 

$ cp cdb1.env orcl.env
$ vi orcl.env

$ vi cdb1.env
$ vi orcl.env

========================================================================================
== ðŸŽ¯ VariÃ¡veis adicionais
========================================================================================
$ env | grep 'ORACLE\|PATH' 

$ cat >> /home/oracle/.bash_profile <<EOF
export SQLPATH=/home/oracle/scripts/
export NLS_DATE_FORMAT="DD/MM/RRRR HH24:MI:SS"
export TNS_ADMIN=\$ORACLE_HOME/network/admin/

export PATH=\$ORACLE_HOME/bin:\$PATH
EOF

$ mkdir /home/oracle/scripts/
$ cat > /home/oracle/scripts/i.sql <<EOF

set lines 1200
col INSTANCE_NAME form a20
col HOST_NAME form a20
col VERSION_FULL form a20
col STATUS form a10
col DATABASE_STATUS form a20
col EDITION form a10

select INSTANCE_NAME,HOST_NAME,VERSION_FULL,STARTUP_TIME,STATUS,LOGINS,DATABASE_STATUS,EDITION
from v\$instance;

EOF

# env | grep 'ORACLE\|PATH' 
$ sqlplus / as sysdba
SQL> @i

========================================================================================
== ðŸŽ¯ ConclusÃ£o
========================================================================================
ðŸ’¡ Sempre seja antento com as variÃ¡veis de ambiente
ðŸ’¡ Domine como definir as variÃ¡veis de ambiente no servidor
ðŸ’¡ Pratique os comandos acima, mas nÃ£o copie e cole
âš ï¸ Compreenda a sutil diferenÃ§a quando vocÃª precisa se conectar em um banco em RAC


======================================================================================================
== ðŸŽ¯ MÃ©todo 1: Compartilhamento de ORACLE_HOME com mÃºltiplos bancos â€” uso dinÃ¢mico via setEnv.sh
======================================================================================================

$ cat /home/oracle/scripts/setEnv.sh

$ sed -i '/^export ORACLE_UNQNAME=/d' /home/oracle/scripts/setEnv.sh
$ sed -i '/^export ORACLE_SID=/d' /home/oracle/scripts/setEnv.sh
$ sed -i '/^export PDB_NAME=/d' /home/oracle/scripts/setEnv.sh

$ sqlplus / as sysdba

======================================================================================================
== ðŸŽ¯ MÃ©todo 2: Compartilhamento de ORACLE_HOME com variÃ¡veis fixas no .bash_profile
======================================================================================================

-- Copiar --> 'Oracle Settings'

$ cat /home/oracle/scripts/setEnv.sh

-- Remover a linha existente que chama o script antigo:

/home/oracle/scripts/setEnv.sh

-- Adicione ao arquivo as 'Oracle Settings'

$ vi /home/oracle/.bash_profile

# Oracle Settings
export TMP=/tmp
export TMPDIR=$TMP

export ORACLE_HOSTNAME=srvdb02.localdomain
export ORACLE_BASE=/u01/app/oracle
export ORACLE_HOME=$ORACLE_BASE/product/19c/db_1
export ORA_INVENTORY=/u01/app/oraInventory
export NLS_DATE_FORMAT="dd-mm-yyyy hh24:mi:ss"
export SQLPATH=/home/oracle/scripts/
export DATA_DIR=/u02/oradata

export PATH=/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin
export PATH=$ORACLE_HOME/bin:$PATH

export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib
