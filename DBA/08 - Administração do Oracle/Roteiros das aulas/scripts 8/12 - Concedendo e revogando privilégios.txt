|-------------------------------------------------------------------------------|
| Aula      : Concedendo e revogando privilÃ©gios                                |
| MÃ³dulo    : Managing Oracle Database                                          |
| Curso     : Oracle Fundamentals                                               |
| Instrutor : Marcio Mandarino                                                  |
| URL       : mrdba.com.br/oracle_fundamentals                                  |
|-------------------------------------------------------------------------------|
| ReferÃªncia: https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/GRANT.html#GUID-20B4E2C0-A7F8-4BC8-A5E8-BE61BDC41AC3
|-------------------------------------------------------------------------------|


=================================================================
== ğŸ¯ Objetivos da Aula:
=================================================================
ğŸ’¡ Aprender a conceder privlÃ©gios no Oracle
ğŸ’¡ Saber diferenciar o privilÃ©gios de sistema e de objetos
ğŸ’¡ Executar alguns casos de uso relacionados a privilÃ©gios no banco


=================================================================
== ğŸ¯ Resumo
=================================================================
ğŸ“ Conceito geral
ğŸ“ System Privileges
ğŸ“ Object Privileges
ğŸ“ Scripts
ğŸ“ ConclusÃ£o


=================================================================
== ğŸ¯ Conceito geral
=================================================================
â–¶ï¸ Para conceder privilÃ©gios, utiliza-se o comando GRANT
â–¶ï¸ VocÃª sÃ³ concede privilÃ©gios, quando vocÃª possui privilÃ©gios para conceder privilÃ©gios
â–¶ï¸ Ter acesso ao objeto, nÃ£o significa que vocÃª pode conceder privilÃ©gio
â–¶ï¸ Caso o usuÃ¡rio conectado seja o owner do objeto, vocÃª pode conceder privilÃ©gios
â–¶ï¸ Existem dois tipos de privilÃ©gios:
	â–«ï¸ PrivilÃ©gios de sistema (System Privileges)
	â–«ï¸ PrivilÃ©gios de objetos (Objects Privileges)
â–¶ï¸ Conceder privilÃ©gios Ã© uma atividade corriqueira no dia a dia do DBA
âš ï¸ NÃ£o conceda privilÃ©gios de mais
âš ï¸ Conceda apenas os privilÃ©gios solicitados. Ã‰ comum que as pessoas nÃ£o saibam o que precisam!


=================================================================
== System Privileges
=================================================================
â–¶ï¸ A view DBA_SYS_PRIVS lista todos os privilÃ©gios de sistema
â–¶ï¸ VocÃª pode atribuir privilÃ©gios de sistema para o usuÃ¡rio ou para a role

-- Select que lista os privilÃ©gios de sistema disponÃ­veis
SQL> select name from system_privilege_map order by 1;

-- cria usario teste1
SQL> create user teste1 identified by teste1;
-- Concede o privilÃ©gio de criar sessÃ£o para o usuÃ¡rio teste1
SQL> grant CREATE SESSION to teste1;
-- Concede mÃºltiplos privilÃ©gios para o usuÃ¡rio teste1
SQL> grant CREATE SESSION,CREATE TABLE,CREATE VIEW to teste1;
-- Concede mÃºltiplos privilÃ©gios para a role RO_SOE_ALL
SQL> grant CREATE SESSION,CREATE TABLE,CREATE VIEW to RO_SOE_ALL;


SQL> set lines 120
SQL> col grantee form a23
SQL> SELECT grantee,
       privilege,
       admin_option
FROM dba_sys_privs
WHERE grantee in ('TESTE1','RO_SOE_ALL') ORDER BY 1;


=================================================================
== Object Privileges
=================================================================
â–¶ï¸ VocÃª pode conceder privilÃ©gios de objetos existentes no banco 
â–¶ï¸ VocÃª pode atribuir privilÃ©gios de objetos para o usuÃ¡rio ou para a role
â–¶ï¸ A view DBA_TAB_PRIVS mostra os privilÃ©gios de objeto
â–¶ï¸ PrivilÃ©gios comuns de objeto:
	â˜‘ï¸ packages, procedures e functions :	EXECUTE
	â˜‘ï¸ sequences: SELECT
	â˜‘ï¸ views: SELECT
	â˜‘ï¸ tabela: SELECT, INSERT, UPDATE, DELETE, REFERENCES
â€¼ï¸ VocÃª nÃ£o concede privilÃ©gioS para "acessar" triggers e indexes

SQL> create table t1 (data date);
-- Concedendo privlÃ©gio de select na tabela t1 para o usuÃ¡rio teste1
SQL> grant select on t1 to teste1;
-- Concedendo mÃºltiplos privilÃ©gios na tabela t1 para a role RO_SOE_ALL
SQL> grant select,insert,update,delete on sys.t1 to RO_SOE_ALL;
-- Concedendo todos os privilÃ©gios na tabela t1 para a role RO_SOE_ALL
SQL> grant all on sys.t1 to RO_SOE_ALL;

-- Consultando as permissÃµes
SQ> set lines 200
SQL> col grantee for a25
SQL> col owner for a25
SQL> col table_name for a30
SQL> SELECT grantee,
       OWNER,
       TABLE_NAME,
       privilege
FROM dba_tab_privs
WHERE grantee in ('TESTE1','RO_SOE_ALL') order by 1,2;


=================================================================
== Scripts
=================================================================
SQL> @privs


=================================================================
== ğŸ¯ ConclusÃ£o
=================================================================
ğŸ’¡ Ã‰ uma tarefa muito tÃ­pica para o DBA criar e manter usuÃ¡rios no banco de dados
ğŸ’¡ Tenha bastante "fluÃªncia" na execuÃ§Ã£o dessas atividades
ğŸ’¡ NÃ£o copie e cole os comandos
