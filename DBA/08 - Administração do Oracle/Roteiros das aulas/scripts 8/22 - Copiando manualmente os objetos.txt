|-------------------------------------------------------------------------------|
| Aula      : Copiando manualmente Objetos										                  |
| MÃ³dulo    : Managing Oracle Database                                          |
| Curso     : Oracle Fundamentals                                               |
| Instrutor : Marcio Mandarino                                                  |
| URL       : mrdba.com.br/oracle_fundamentals                                  |
|-------------------------------------------------------------------------------|
| ReferÃªncia: https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_METADATA.html#GUID-F5238363-CC40-47F7-8973-05BD95030231
|-------------------------------------------------------------------------------|


=================================================================
== ğŸ¯ Objetivos da Aula:
=================================================================
ğŸ’¡ Compreender como copiar objetos do banco de dados de forma manual e individual


=================================================================
== ğŸ¯ Resumo
=================================================================
ğŸ“ Conceito geral
ğŸ“ O Pacote DBMS_METADATA.GET_DDL
ğŸ“ CenÃ¡rio 1
ğŸ“ Script para sua caixa de ferramentas
ğŸ“ Boas prÃ¡ticas
ğŸ“ ConclusÃ£o


=================================================================
== ğŸ¯ Conceito geral
=================================================================
â–¶ï¸ No dia a dia, Ã© muito comum o DBA estar copiando objetos do banco "de um lado para o outro"
â–¶ï¸ TambÃ©m Ã© comum receber solicitaÃ§Ãµes do time de Dev pedindo o "DDL" de um determinado objeto do banco
â–¶ï¸ Quando precisamos fazer essa atividade para um ou poucos objetos, normalmente Ã© feito de forma "manual" 
â–¶ï¸ Existem vÃ¡rias formas de se pegar o DDL de um objeto do banco, por exemplo:
	â–«ï¸ Sql Developer
	â–«ï¸ SqlCl
	â–«ï¸ Pacote DBMS_METADATA.GET_DDL
ğŸ’¡ Na prÃ¡tica, todas as ferramentas usam o pacote DBMS_METADATA.GET_DDL

=================================================================
== ğŸ¯ O Pacote DBMS_METADATA.GET_DDL
=================================================================
SQL> select
     dbms_metadata.get_ddl('TABLE',TABLE_NAME,'SOE')
    FROM DBA_TABLES WHERE OWNER = 'SOE' AND TABLE_NAME = 'ADDRESSES';

=================================================================
== ğŸ¯ CenÃ¡rio 1
=================================================================
SolicitaÃ§Ã£o: Copiar a tabela LOGON do usuÃ¡rio SOE do ambiente de produÃ§Ã£o para o ambiente de desenvolvimento

-- Criar usuÃ¡rio no ambiente de DEV
SQL> create user soe identified by soe;
SQL> alter user  soe quota unlimited on soe;
SQL> grant create session, create table, create database link to soe;


-- Criar database link no ambiente de DEV apontando para a base de produÃ§Ã£o
SQL> CREATE DATABASE LINK dblk_srvprd01_soe
CONNECT TO soe IDENTIFIED BY "SOE"
USING '(DESCRIPTION =
  (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.68.112)(PORT = 1521))
  (CONNECT_DATA = (SERVICE_NAME = orcl)))';


CREATE DATABASE LINK dblk_srvprd01_soe2
CONNECT TO soe IDENTIFIED BY "SOE"
USING 'ORCL';


select count(1) from "SOE"."LOGON"@DBLK_SRVPRD01_SOE

SQL> insert into "SOE"."LOGON" (select * from "SOE"."LOGON"@DBLK_SRVPRD01_SOE);
SQL> commit;
SQL> ALTER SESSION CLOSE DATABASE LINK dblk_srvprd01_soe;
SQL> drop DATABASE LINK dblk_srvprd01_soe;



=================================================================
== ğŸ¯ Script para sua caixa de ferramentas
=================================================================
@ddl

=================================================================
== ğŸ¯ Boas prÃ¡ticas
=================================================================
ğŸ’¡ Ao enviar o DDL de um objeto, evite enviar as configuraÃ§Ãµes de storage
ğŸ’¡ Quando alguÃ©m pedir o DDL de uma tabela, procure entender se ele tambÃ©m quer o DDL dos objetos associados (triggers, indexes, constraints)


=================================================================
== ğŸ¯ ConclusÃ£o
=================================================================
ğŸ’¡ VocÃª tem que ser esperto nessa atividade, pois ela Ã© bÃ¡sica para um DBA
ğŸ’¡ Pratique as atividades dessa aula, copie objetos usando todos os recursos
ğŸ’¡ Salve os scripts utilizados nessa aula na sua pasta de scripts
ğŸ’¡ Domine os scripts utilizados nessa aula!
