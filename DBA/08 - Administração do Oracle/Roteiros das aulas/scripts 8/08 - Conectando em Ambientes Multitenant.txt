|-------------------------------------------------------------------------------|
| Aula      : Conectando em Ambientes Multitenant								|
| MÃ³dulo    : Managing Oracle Database                                          |
| Curso     : Oracle Fundamentals                                               |
| Instrutor : Marcio Mandarino                                                  |
| URL       : mrdba.com.br/oracle_fundamentals                                  |
|-------------------------------------------------------------------------------|
| ReferÃªncia: https://docs.oracle.com/en/database/oracle/oracle-database/19/multi/managing-a-multitenant-environment.html#GUID-93F1E584-D309-4301-82E0-AD0E60D4977C
|-------------------------------------------------------------------------------|


=================================================================
== ğŸ¯ Objetivos da Aula:
=================================================================
ğŸ’¡ Entender a configuraÃ§Ã£o e o uso do arquivo tnsnames.ora
ğŸ’¡ Configurar a variÃ¡vel de ambiente ORACLE_PDB_SID
ğŸ’¡ Utilizar os comandos: SHOW PDBS, SHOW CON_NAME e ALTER SESSION SET CONTAINER
ğŸ’¡ Compreender as diferenÃ§as entre se conectar em um ambiente container e nÃ£o container


=================================================================
== ğŸ¯ Resumo
=================================================================
ğŸ“ Conceito geral
ğŸ“ ConfiguraÃ§Ã£o do arquivo tnsnames.ora
ğŸ“ VariÃ¡vel de Ambiente ORACLE_PDB_SID
ğŸ“ Comandos Ãšteis para Multitenant
ğŸ“ ConclusÃ£o


=================================================================
== ğŸ¯ Conceito geral
=================================================================
â–¶ï¸ Existem vÃ¡rias formas de se conectar em ambiente multitenant database
â–¶ï¸ VocÃª precisa ficar atento a qual ambiente vocÃª precisa se conectar
â–¶ï¸ O ideal Ã© que vocÃª deixe as conexÃµes do seu desktop prontas para todos os pdbs e cdbs


=================================================================
== ğŸ¯ ConfiguraÃ§Ã£o do arquivo tnsnames.ora
=================================================================
â–¶ï¸ O tnsnames pode (e deve) ser configurado tanto no servidor quanto na sua estaÃ§Ã£o de trabalho
â–¶ï¸ A configuraÃ§Ã£o do tnsnames Ã© exatamente a mesma quando configuramos na nossa estaÃ§Ã£o e no servidor
â–¶ï¸ Mantenha o seu tnsnames sempre organizado e procure sempre usar comentÃ¡rios para esclarecer o motivo 
â–¶ï¸ Exemplos de tnsnames:

PDB1=(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.68.128)   (PORT=1521))  (CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=PDB1)))

PDB1 =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.68.128)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = PDB1)
    )
  )

$ cd /u01/app/oracle/product/19c/db_1/network/admin
$ tnsping cdb1
$ sqlplus sys/"Wellcome1"@pdb1 as sysdba

=================================================================
== ğŸ¯ VariÃ¡vel de Ambiente ORACLE_PDB_SID
=================================================================
â–¶ï¸ A variÃ¡vel de ambiente ORACLE_PDB_SID Ã© usada para especificar o PDB ao qual um cliente deve se conectar.

$ export ORACLE_PDB_SID=ORCLPDB1


=================================================================
== ğŸ¯ Comandos Ãšteis para Multitenant
=================================================================
â–¶ï¸ Exibe todos os PDBs no CDB atual:
SQL> SHOW PDBS;

â–¶ï¸ Mostra o nome do container atual ao qual o usuÃ¡rio estÃ¡ conectado:
SQL> SHOW CON_NAME;
SQL> SELECT SYS_CONTEXT ('USERENV', 'CON_NAME') FROM DUAL;


â–¶ï¸ Muda o container atual para o PDB especificado
SQL> ALTER SESSION SET CONTAINER = PDB1;

â–¶ï¸ Muda o container atual para container root
SQL> ALTER SESSION SET CONTAINER = cdb$root;


=================================================================
== ğŸ¯ ConclusÃ£o
=================================================================
ğŸ’¡ Ambientes Multitenant nÃ£o Ã© o ambiente mais comum, mas vocÃª deve estar preparado para eles
ğŸ’¡ Saber se conectar em ambiente Multitenant Ã© algo muito bÃ¡sico, um DBA deve saber! 